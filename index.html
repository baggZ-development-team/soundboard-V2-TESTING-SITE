<!DOCTYPE html>
<html lang="en-GB">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FWZLJYXDTE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FWZLJYXDTE');
</script>
    <meta charset="utf-8" />
    <title>Soundboard</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.fog.min.js"></script>
</head>
<body id="vanta-background">
    <h1>baggZ Soundboard</h1>
    <h3 id="loading">If a sound isn't working wait a second.</h3>

    <div id="search-container">
        <input type="text" id="searchBar" placeholder="Search sounds...">
    </div>

    <button id="stopBtn" class="glass-button"><span>Stop</span></button>

    <div id="buttons" display="none"></div>

    <!-- SVG DISTORTION FILTER -->
    <svg width="0" height="0" style="position:absolute">
        <defs>
            <filter id="glass-distortion" x="0%" y="0%" width="100%" height="100%">
                <feTurbulence
                    type="fractalNoise"
                    baseFrequency="0.01 0.01"
                    numOctaves="2"
                    seed="42"
                    result="noise"
                />
                <feGaussianBlur in="noise" stdDeviation="1.5" result="blurred" />
                <feDisplacementMap
                    in="SourceGraphic"
                    in2="blurred"
                    scale="60"
                    xChannelSelector="R"
                    yChannelSelector="G"
                />
            </filter>
        </defs>
    </svg>

    <script>
        // Vibrant color palette
        const vibrantColors = [
            0xff006e, // Hot Pink
            0x8338ec, // Purple
            0x3a86ff, // Bright Blue
            0x06ffa5, // Cyan
            0xffbe0b, // Yellow
            0xfb5607, // Orange
            0xff006e, // Magenta
            0x8338ec, // Violet
            0x06ffa5, // Aqua
            0xff006e, // Pink
            0x3a86ff, // Electric Blue
            0xffbe0b, // Gold
            0xfb5607, // Red Orange
            0x8338ec, // Indigo
            0x06ffa5, // Mint
        ];

        // Initialize Vanta Fog with random vibrant colors
        function initVanta() {
            const baseColor = vibrantColors[Math.floor(Math.random() * vibrantColors.length)];
            const highlightColor = vibrantColors[Math.floor(Math.random() * vibrantColors.length)];
            const midColor = vibrantColors[Math.floor(Math.random() * vibrantColors.length)];

            VANTA.FOG({
                el: "#vanta-background",
                mouseControls: true,
                touchControls: true,
                gyroControls: false,
                minHeight: 200.00,
                minWidth: 200.00,
                highlightColor: highlightColor,
                baseColor: baseColor,
                midColor: midColor,
                blurFactor: 0.47,
                speed: 1.5,
                zoom: 0.9
            });
        }

        // Initialize Vanta after page load
        window.addEventListener('load', initVanta);

        // Search functionality
        (async () => {
            const res = await fetch("Audios.json");
            const data = await res.json();

            const stopBtn = document.getElementById("stopBtn");
            const container = document.getElementById("buttons");
            const searchBar = document.getElementById("searchBar");
            const loading = document.getElementById("loading");

            let currentAudio = null;
            let allButtons = [];

            // Create buttons
            data.files.forEach(file => {
                const btn = document.createElement("button");
                const displayName = file.split(".")[0].replace(/[_-]/g, " ");
                btn.classList.add("glass-button");
                btn.dataset.searchText = displayName.toLowerCase();

                const span = document.createElement("span");
                span.textContent = displayName;
                btn.appendChild(span);

                const audio = new Audio(`audio/${file}`);
                
                btn.onclick = () => {
                    if (currentAudio && currentAudio !== audio) {
                        currentAudio.pause();
                        currentAudio.currentTime = 0;
                    }
                    currentAudio = audio;
                    audio.play();
                };

                container.appendChild(btn);
                allButtons.push(btn);
            });

            // Hide loading message after buttons are created
            loading.style.display = "none";

            // Search functionality
            searchBar.addEventListener("input", (e) => {
                const searchTerm = e.target.value.toLowerCase();
                allButtons.forEach(btn => {
                    if (btn.dataset.searchText.includes(searchTerm)) {
                        btn.style.display = "inline-block";
                    } else {
                        btn.style.display = "none";
                    }
                });
            });

            stopBtn.onclick = () => {
                if (currentAudio) {
                    currentAudio.pause();
                    currentAudio.currentTime = 0;
                }
            };
        })();
    </script>
</body>
</html>
