<!DOCTYPE html>
<html lang="en-GB">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FWZLJYXDTE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FWZLJYXDTE');
</script>
    <meta charset="utf-8" />
    <title>Soundboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>baggZ Soundboard</h1>
    <h2 id="loading">Loading...</h2>

    <div id="buttons" display="none"></div>

    <script>
        (async () => {
    const res = await fetch("Audios.json");
    const data = await res.json();

    const container = document.getElementById("buttons");
    const soundFiles = data.files;

    let loadedCount = 0;
    const sounds = {};

    function checkAllLoaded() {
        loadedCount++;
        if (loadedCount === soundFiles.length) {
            // All sounds are loaded
            document.getElementById("loading").remove();
            container.style.display = "block";
        }
    }

    soundFiles.forEach(file => {
        const btn = document.createElement("button");
        btn.textContent = file.split(".")[0].replace(/[_-]/g, " ");

        const audio = new Audio(`audio/${file}`);
        audio.preload = "auto";

        // Wait until the sound can play through
        audio.addEventListener("canplaythrough", checkAllLoaded, { once: true });
        audio.addEventListener("error", checkAllLoaded, { once: true }); // fail-safe

        btn.onclick = () => audio.play();
        container.appendChild(btn);

        sounds[file] = audio;
    });
})();
    </script>
</body>
</html>
